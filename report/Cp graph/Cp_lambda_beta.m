close all
clc 
clear

RPM = [374 430 621 660;
       166 596 926 960;
       376 638 710 752;
       312 355 528 482;
       347 383 440 508;];
r = 0.175;
Vw = [2.5 3.0 3.5 4.0;
      2.0 3.0 3.5 4.0;
      2.5 3.0 3.5 4.0;
      2.0 2.5 3.5 4.5;
      2.5 3.0 3.5 4.0;];

%--------------------------------------------------
beta = [0  0  0  0 ;
        15 15 15 15;
        20 20 20 20;
        30 30 30 30;
        35 35 35 35;
        ];                          % have beta
%--------------------------------------------------
P = [0.036 0.048 0.131 0.134;
     0.170 0.107 0.187 0.285;
     0.050 0.109 0.146 0.206;
     0.013 0.035 0.098 0.077;
     0.022 0.033 0.055 0.077;];

%--------------------------------------------------
% figure()
% hold on
% plot(Vw(3,:), RPM(3,:), 'x')
% title('RPM vs v_w raw')
% xlabel('Vw')
% ylabel('RPM')
% hold off
% RPM(1,:) = 210 * Vw(1,:) - 160;
% RPM(2,:) = 420 * Vw(2,:) - 660;
% RPM(3,:) = 240 * Vw(3,:) - 160;
% RPM(4,:) = 78 * Vw(4,:) + 180;
% RPM(5,:) = 110 * Vw(5,:) + 69;
%---------------------------------------------------
w = 2 * pi / 60 .* RPM;
LAMBDA = w * r  ./ Vw;

rho = 1.225;
A = pi * r^2;
Cp = 2 .* P ./ (Vw.^3 .* (rho * A));  % calculate Cp
%---------------------------------------------------
figure()
surf(LAMBDA, beta, Cp)
title('CP-Lambda-beta')
xlabel('Lambda')
ylabel('beta(degree)')
zlabel('Cp')